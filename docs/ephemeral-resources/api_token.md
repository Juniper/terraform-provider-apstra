---
page_title: "apstra_api_token Ephemeral Resource - terraform-provider-apstra"
subcategory: "Authentication"
description: |-
  This Ephemeral Resource retrieves a unique API token and invalidates it on exit.
---

# apstra_api_token (Ephemeral Resource)

This Ephemeral Resource retrieves a unique API token and invalidates it on exit.


## Example Usage

```terraform
# This example runs uses the apstra_api_token ephemeral resource
# to collect an API key which is then used in an arbitrary shell
# command.
locals {
  url = "https://apstra.example.com"
}

provider "apstra" {
  url                     = local.url
  blueprint_mutex_enabled = false
}

// fetch an API token
ephemeral "apstra_api_token" "example" {}

resource "null_resource" "example" {
  provisioner "local-exec" {
    command = "curl -X OPTIONS $URL -H 'accept: application/json' -H \"Authtoken: $APIKEY\" > /tmp/local-exec.out"
    environment = {
      APIKEY = ephemeral.apstra_api_token.example.value
      URL    = format("%s/api/blueprints", local.url)
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `do_not_log_out` (Boolean) By default, API sessions are closed when Terraform's `Close` operation calls `logout`. Set this value to `true` to prevent ending the session when Terraform determines the API key is no longer in use.
- `warn_seconds` (Number) Terraform will produce a warning when the token value is referenced with less than this amount of time remaining before expiration. Note that determination of remaining token lifetime depends on clock sync between the Apstra server and the Terraform host. Value `0` disables warnings. Default value is `60`.

### Read-Only

- `session_id` (String) The API session ID associated with the token.
- `user_name` (String) The user name associated with the session ID.
- `value` (String) The API token value.
