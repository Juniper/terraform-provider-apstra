---
page_title: "apstra_api_token Ephemeral Resource - terraform-provider-apstra"
subcategory: "Authentication"
description: |-
  This Ephemeral Resource retrieves a unique API token and (optionally) invalidates it on Close.
---

# apstra_api_token (Ephemeral Resource)

This Ephemeral Resource retrieves a unique API token and (optionally) invalidates it on Close.


## Example Usage

```terraform
# This example runs uses the apstra_api_token ephemeral resource
# to collect an API key which is then used in an arbitrary shell
# command.
locals {
  url = "https://apstra.example.com"
}

provider "apstra" {
  url                     = local.url
  blueprint_mutex_enabled = false
}

// fetch an API token
ephemeral "apstra_api_token" "example" {}

resource "null_resource" "example" {
  provisioner "local-exec" {
    command = "curl -X OPTIONS $URL -H 'accept: application/json' -H \"Authtoken: $APIKEY\" > /tmp/local-exec.out"
    environment = {
      APIKEY = ephemeral.apstra_api_token.example.value
      URL    = format("%s/api/blueprints", local.url)
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `do_not_log_out` (Boolean) By default, tokens / API sessions produced by this resource are invalidated by calling Apstra's `logout` API when Terraform invokes `Close` on this resource. Setting this attribute to `true` changes that behavior. `logout` will not be called, and the token produced by this resource will remain valid until it expires or something else invalidates it.
- `warn_seconds` (Number) Terraform will produce a warning when the token value is referenced with less than this amount of time remaining before expiration. Note that determination of remaining token lifetime depends on clock sync between the Apstra server and the Terraform host. Value `0` disables warnings. Default value is `60`.

### Read-Only

- `session_id` (String) The API session ID associated with the token.
- `user_name` (String) The user name associated with the session ID.
- `value` (String) The API token value.
