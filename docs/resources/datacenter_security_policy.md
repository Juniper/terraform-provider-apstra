---
page_title: "apstra_datacenter_security_policy Resource - terraform-provider-apstra"
subcategory: "Reference Design: Datacenter"
description: |-
  This resource creates a Security Policy within a Datacenter Blueprint.
---

# apstra_datacenter_security_policy (Resource)

This resource creates a Security Policy within a Datacenter Blueprint.


## Example Usage

```terraform
# The following example creates a pair of policies which allow only HTTPS
# and ICMP traffic from clients on network "iBs6gKOBpZgBzXYaMzI"to servers
# on network "bIo0YmuXqFB4_BmAHAE".

resource "apstra_datacenter_security_policy" "client_traffic" {
  blueprint_id                     = "a52fb4ff-b352-46a3-9141-820b40972133"
  name                             = "http client traffic out"
  description                      = "Allow outbound to TCP/443 and ICMP traffic. Block all others."
  source_application_point_id      = "iBs6gKOBpZgBzXYaMzI"
  destination_application_point_id = "bIo0YmuXqFB4_BmAHAE"
  rules = [
    {
      name         = "permit_tcp_443"
      description  = "Permit client traffic on TCP/443 to servers"
      action       = "permit"
      protocol     = "tcp"
      source_ports = null // null == "any"
      destination_ports = [
        {
          from_port = 443
          to_port   = 443
        }
      ]
    },
    {
      name        = "permit_icmp"
      description = "Permit ICMP"
      action      = "permit_log"
      protocol    = "icmp"
    },
    {
      name        = "deny_all_ip"
      action      = "deny_log"
      protocol    = "ip"
    },
  ]
}

resource "apstra_datacenter_security_policy" "server_traffic" {
  blueprint_id                     = "a52fb4ff-b352-46a3-9141-820b40972133"
  name                             = "http server traffic replies"
  description                      = "Allow inbound established flows from TCP/443 and ICMP traffic. Block all others."
  source_application_point_id      = "bIo0YmuXqFB4_BmAHAE"
  destination_application_point_id = "iBs6gKOBpZgBzXYaMzI"
  rules = [
    {
      name        = "permit_tcp_443"
      description = "Permit server replies on TCP/443"
      action      = "permit"
      protocol    = "tcp"
      established = true
      source_ports = [
        {
          from_port = 443
          to_port   = 443
        }
      ]
      destination_ports = null // null == "any"
    },
    {
      name        = "permit_icmp"
      description = "Permit ICMP"
      action      = "permit_log"
      protocol    = "icmp"
    },
    {
      name        = "deny_all_ip"
      action      = "deny_log"
      protocol    = "ip"
    },
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `blueprint_id` (String) Apstra Blueprint ID.
- `name` (String) Security Policy name.

### Optional

- `description` (String) Security Policy description, as seen in the Web UI.
- `destination_application_point_id` (String) Graph node ID of the destination Application Point (Virtual Network ID, Routing Zone ID, etc...)
- `enabled` (Boolean) Indicates whether the Security Policy is enabled. Default value: `true`
- `rules` (Attributes List) Not currently supported for use in a filter. Do you need this? Let us know by [opening an issue](https://github.com/Juniper/terraform-provider-apstra/issues/new)! (see [below for nested schema](#nestedatt--rules))
- `source_application_point_id` (String) Graph node ID of the source Application Point (Virtual Network ID, Routing Zone ID, etc...)
- `tags` (Set of String) Set of Tags. All tags supplied here are used to match the Security Policy, but a matching Security Policy may have additional tags not enumerated in this set.

### Read-Only

- `id` (String) Not applicable in filter context. Ignore.

<a id="nestedatt--rules"></a>
### Nested Schema for `rules`

Required:

- `action` (String) Action - One of: deny, deny_log, permit, permit_log
- `name` (String) Security Policy Rule Name.
- `protocol` (String) Security Policy Rule Protocol; one of: 'icmp', 'ip', 'tcp', 'udp'

Optional:

- `description` (String) Security Policy Rule Description.
- `destination_ports` (Attributes Set) Set of TCP/UDP destination ports matched by this rule. A `null` set matches any port. Valid only when `protocol` is `tcp` or `udp`. (see [below for nested schema](#nestedatt--rules--destination_ports))
- `established` (Boolean) When `true`, the rendered rule will use the NOS `established` or `tcp-established` keyword/feature for TCP access control list entries.
- `source_ports` (Attributes Set) Set of TCP/UDP source ports matched by this rule. A `null` set matches any port. Valid only when `protocol` is `tcp` or `udp`. (see [below for nested schema](#nestedatt--rules--source_ports))

Read-Only:

- `id` (String) Security Policy Rule ID.

<a id="nestedatt--rules--destination_ports"></a>
### Nested Schema for `rules.destination_ports`

Required:

- `from_port` (Number) First (low) port number in a range of ports matched by the policy rule.
- `to_port` (Number) Last (high) port number in a range of ports matched by the policy rule.


<a id="nestedatt--rules--source_ports"></a>
### Nested Schema for `rules.source_ports`

Required:

- `from_port` (Number) First (low) port number in a range of ports matched by the policy rule.
- `to_port` (Number) Last (high) port number in a range of ports matched by the policy rule.



